# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
# SPDX-License-Identifier: Apache-2.0

settings:
  env:
    # Allow percentage of Fargate Container memory as heap for JMeter.
    # The same amount will be used for -XX:MaxDirectMemorySize (leaving at least 20%).
    HEAP: -XX:MaxRAMPercentage=40 -XX:InitialRAMPercentage=40

modules:
  jmeter:
    path: ~/.bzt/jmeter-taurus/{version}/bin/jmeter
    download-link: https://archive.apache.org/dist/jmeter/binaries/apache-jmeter-{version}.zip
    version: 5.6.3
    force-ctg: true
    detect-plugins: true
    fix-jars: true
    plugins:
    - jpgc-autostop
    - jpgc-casutg
    - jpgc-dummy
    - jpgc-ffw
    - jpgc-fifo
    - jpgc-functions
    - jpgc-prmctl
    - jpgc-tst
    - jpgc-redis
    - jpgc-jmxmon
    - bzm-http2
    - websocket-samplers
    # Suppress warnings "Existing CookieManager ... superseded by ..." due to https://github.com/apache/jmeter/issues/6457
    cmdline: --loglevel org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase=ERROR
    plugins-manager:
      download-link: https://search.maven.org/remotecontent?filepath=kg/apc/jmeter-plugins-manager/{version}/jmeter-plugins-manager-{version}.jar
      version: '1.11'
    command-runner:
      download-link: https://search.maven.org/remotecontent?filepath=kg/apc/cmdrunner/{version}/cmdrunner-{version}.jar
      version: 2.3
